{"version":3,"sources":["./src/app/deviceslist/deviceslist-routing.module.ts","./src/app/deviceslist/deviceslist.module.ts","./src/app/deviceslist/deviceslist.page.html","./src/app/deviceslist/deviceslist.page.scss","./src/app/deviceslist/deviceslist.page.ts"],"names":[],"mappings":"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","file":"deviceslist-deviceslist-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { DeviceslistPage } from './deviceslist.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: DeviceslistPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class DeviceslistPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { DeviceslistPageRoutingModule } from './deviceslist-routing.module';\n\nimport { DeviceslistPage } from './deviceslist.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    DeviceslistPageRoutingModule\n  ],\n  declarations: [DeviceslistPage]\n})\nexport class DeviceslistPageModule {}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title> Devices List </ion-title>\\n    <ion-button size=\\\"small\\\" slot=\\\"end\\\" color=\\\"primary\\\" (click)=\\\"showAlert()\\\" >Add</ion-button>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n<ion-list>\\n <!--   <ion-item *ngFor=\\\"let device of devices\\\">\\n    <ion-icon name=\\\"water\\\" slot=\\\"start\\\"></ion-icon>\\n    <ion-label> {{device.name}} </ion-label>\\n    <ion-icon name=\\\"arrow-forward-circle\\\" (click)=\\\"deleteDevice(device.id)\\\"></ion-icon>\\n  </ion-item> -->\\n</ion-list>\\n\\n\\n<ion-item-sliding *ngFor=\\\"let device of devices\\\">\\n  <ion-item-options side=\\\"start\\\">\\n    <ion-item-option color=\\\"danger\\\" (click)=\\\"deleteDevice(device.id)\\\">\\n      <ion-icon slot=\\\"icon-only\\\" name=\\\"trash\\\"></ion-icon></ion-item-option>\\n  </ion-item-options>\\n\\n  <ion-item>\\n    <ion-icon name=\\\"logo-apple-ar\\\" slot=\\\"start\\\"></ion-icon>\\n    <ion-label>{{device.name}}</ion-label>\\n    <ion-icon name=\\\"arrow-forward-circle\\\" ></ion-icon>\\n    \\n  </ion-item>\\n\\n</ion-item-sliding> \\n\\n</ion-content>\\n\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJkZXZpY2VzbGlzdC5wYWdlLnNjc3MifQ== */\";","import { Component, OnDestroy, OnInit } from '@angular/core'; \nimport { AlertController } from '@ionic/angular';\nimport { MainApiService } from '../services/main-api.service';\nimport firebase from 'firebase/app';\nimport 'firebase/firestore'; //นำเข้าข้อมูล firestoreมาจาก firebase\n@Component({\n  selector: 'app-deviceslist',\n  templateUrl: './deviceslist.page.html',\n  styleUrls: ['./deviceslist.page.scss'],\n})\nexport class DeviceslistPage implements OnInit, OnDestroy  { \n  fetching: { [key: string]: any } = {};\n  devices: any;\n  constructor(\n    private alertCtrl: AlertController, private mainApiService: MainApiService\n  ) { }\n\n  ngOnInit() {\n    this.getDevices();\n  }\n\n  getDevices() {\n    this.fetching.onSnapshotDevices = this.mainApiService.dbGateways.where('isDelete', '==', false).onSnapshot(res => {\n      const devices = [];\n      res.forEach(doc => {\n        if (doc.exists) {\n          devices.push(doc.data());\n        }\n      });\n\n      this.devices = devices;\n      console.log('devices => ', this.devices);\n    });\n  }\n  async showAlert() { //แสดง pop up  Alert \n    await this.alertCtrl.create({\n      header: 'Add Devices',\n      subHeader: 'Devices ',\n      inputs: [\n        { type: 'text', name: 'device', placeholder: 'Devices Name' }\n      ],\n\n      buttons: [\n        {\n          text: 'Add', handler: (res) => {\n            console.log(res.device);\n            if (res.device) {\n              this.addDevice(res.device);\n            } else {\n              alert('ว่างเปล่า');\n            }\n          }\n        },\n        {\n          text: 'Cancel'\n        }\n      ]\n    }).then(res => res.present());\n  }\n\n  async deleteDevice(deviceId) {\n    await this.alertCtrl.create({\n      header: 'Device Devices',\n      subHeader: 'Devices ',\n      buttons: [\n        {\n          text: 'Okay', handler: (res) => {\n            this.mainApiService.dbGateways.doc(deviceId).update({\n              isDelete: true,\n              isActive: false,\n              updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n            });\n          }\n        },\n        {\n          text: 'Cancel'\n        }\n      ]\n    }).then(res => res.present());\n  }\n\n  updateDevice(device) {\n    const dataUpdate = {\n      name: device.name,\n      updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      updateTest: 'อัพเดตนะจะ'\n    };\n\n    this.mainApiService.dbGateways.doc(device.id).update(dataUpdate).then(res => {\n      alert('update success');\n      \n    }).catch(err => {\n      console.log(err);\n\n    });\n  }\n\n  addDevice(deviceName) { //คำสั่ง เพิ่ม device\n    const dataAdd = { //เพิ่มข้อมูล\n      name: deviceName, //เพิ่ม devicename ที่มาจาก pop up showalert \n      createdAt: firebase.firestore.FieldValue.serverTimestamp(), //เพิ่มเวลาตอนที่สร้าง จาก firebase\n      isActive: true, //เพิ่มค่าสถานะ isActive ให้เป็น True = แสดง\n      isDelete: false, //เพิ่มค่าสถานะ isDelete เพื่อให้รู้ข้อมูลถูกลบจาก add แต่ยังคงอยู๋ใน firestore \n    };\n    this.mainApiService.dbGateways.add(dataAdd).then(resAdd => { //ติดต่อ firebase ด้วย mainapiservice แล้วไปที่ dbgateway แล้ว add ข้อมูลจาก dataadd ข้างบน ลงไปอยู่ firestore\n      this.mainApiService.dbGateways.doc(resAdd.id).update({ //และเพิ่ม id ลงไป firestore ด้วย\n        id: resAdd.id\n      }).then(resUpdateId => { //มีการ updateid ให้ขึ้น alert และแสดงใน console ว่า success\n        alert('success');\n        console.log('success');\n        //แสดง log  succes ในหน้า console\n      }).catch(err => {\n        console.log(err);\n        //แสดง log  eror ในหน้า console\n      });\n    }).catch(err => {\n      console.log(err)\n      //แสดง log eror ในหน้า console\n    });\n  }\n  //คำสั่่ง ล้างแคชเมื่อออกจากการปิดหน้า\n  ngOnDestroy(): void { //void ไม่คืนค่า medtord\n    for (const key in this.fetching) {   //วนด้วยคำสั่ง for if\n      if (this.fetching.hasOwnProperty && this.fetching[key]) {\n        if (key.indexOf('unsubscribe') > -1) { //ถ้า index เป็น unsub มากกว่า -1 ให้ทำคำสั่งให้ทำ unsubscribe\n          this.fetching[key].unsubscribe();\n        } else {  //ถ้าไม่ มากกว่า -1 ไม่ทำคำสั่ง และวนๆไปเรื่อยๆ จน เป็น -1 \n          this.fetching[key]();\n        }\n      }\n    }\n  }\n\n  async devicedetail(id){\n     \n  }\n\n  nextpage() {\n  }\n\n}\n"],"sourceRoot":"webpack:///"}